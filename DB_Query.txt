DROP TABLE IF EXISTS [user];
DROP TABLE IF EXISTS [trader];
DROP TABLE IF EXISTS [ship];
DROP TABLE IF EXISTS [item];
DROP TABLE IF EXISTS [items_ships];
DROP TABLE IF EXISTS [custom_duty];


CREATE TABLE [dbo].[user] (
    [Id]            INT         IDENTITY (1, 1) NOT NULL,
    [first_name]    VARCHAR (100) NULL,
    [last_name]     VARCHAR (100) NULL,
    [email]         VARCHAR (255) NULL,
    [password_hash] VARCHAR (100) NULL,
    [cnic]          VARCHAR (100) NULL,
    [user_type]     INT         NULL,
    [gender]        INT         NULL,
    [created_at]    DATETIME    NULL,
    [updated_at]    DATETIME    NULL,
    PRIMARY KEY CLUSTERED ([Id] ASC)
);

CREATE TABLE [dbo].[trader] (
    [user_id]         INT         NOT NULL,
    [nationality]     VARCHAR (100) NULL,
    [trading_number]  VARCHAR (100) NULL
);

CREATE TABLE [dbo].[ship] (
    [id]                  INT         IDENTITY (1, 1) NOT NULL,
    [hin]                 VARCHAR (100) NOT NULL,
    [trader_id]           INT NOT NULL,
    [nick_name]           VARCHAR (100) NULL,
    [allocated_birth]     INT NULL,
    [allocated_terminal]  INT NULL,
    [created_at] DATETIME NULL, 
    [updated_at] DATETIME NULL, 
    PRIMARY KEY CLUSTERED ([Id] ASC)
);

CREATE TABLE [dbo].[item] (
    [id]                  INT         IDENTITY (1, 1) NOT NULL,
    [name]                VARCHAR (255) NOT NULL,
    [quantity]            INT NOT NULL,
    [price]               DECIMAL NOT NULL DEFAULT 0,
    [currency]            VARCHAR(10) NOT NULL DEFAULT 'PKR',
    [trader_id]           INT NOT NULL,
    [created_at] DATETIME NULL,
    [updated_at] DATETIME NULL,
    PRIMARY KEY CLUSTERED ([Id] ASC)
);

CREATE TABLE [dbo].[items_ships] (
    [item_id]             INT NOT NULL,
    [ship_id]             INT NOT NULL,
    [created_at] DATETIME NULL, 
    [updated_at] DATETIME NULL
);

CREATE TABLE [dbo].[custom_duty] (
    [id]                  INT         IDENTITY (1, 1) NOT NULL,
    [amount]              DECIMAL NOT NULL DEFAULT 0,
    [currency]            VARCHAR(10) NOT NULL DEFAULT 'PKR',
    [ship_id]             INT NOT NULL,
    [status]              VARCHAR(10) NOT NULL DEFAULT 'Unpaid',
    [due_date]   DATETIME NULL,
    [paid_at]    DATETIME NULL,
    [created_at] DATETIME NULL,
    [updated_at] DATETIME NULL,
    PRIMARY KEY CLUSTERED ([Id] ASC)
);


-- Dummy data
INSERT INTO [user] (first_name, last_name, email, password_hash, cnic, user_type, gender, created_at, updated_at) VALUES ('Mr.', 'Admin', 'admin@gmail.com', 'password', '123-123-1', 0, 0, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP);
INSERT INTO [user] (first_name, last_name, email, password_hash, cnic, user_type, gender, created_at, updated_at) VALUES ('Henry', 'Trader', 'henry@gmail.com', 'password', '123-123-2', 1, 0, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP);
INSERT INTO [user] (first_name, last_name, email, password_hash, cnic, user_type, gender, created_at, updated_at) VALUES ('Lisa', 'Staff', 'lisa@gmail.com', 'password', '123-123-3', 2, 1, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP);